--- Khởi tạo quần thể ---
For i = 1 → pop_size:
    Tạo vector vị trí x_i ngẫu nhiên trong bounds
    Tính fitness_i = f(x_i)
    trial_i = 0
End For

best_solution = nghiệm có fitness tốt nhất

--- Vòng lặp chính ---
For iter = 1 → max_iter:

    --- Pha ong thợ ---
    For i = 1 → pop_size:
        Chọn ngẫu nhiên j ≠ i
        Chọn ngẫu nhiên 1 chiều dim
        Chọn φ ∈ [-1, 1]
        Tạo nghiệm lân cận:
            v_i[dim] = x_i[dim] + φ * ( x_i[dim] - x_j[dim] )
        Áp dụng ràng buộc biên cho v_i
        Nếu f(v_i) < f(x_i):
            x_i = v_i
            trial_i = 0
        Ngược lại:
            trial_i = trial_i + 1
    End For

    --- Pha ong quan sát ---
    Tính fitness nghịch đảo:
        inv_fit_i = 1 / (fitness_i + ε)
    Tính tổng S = Σ inv_fit_i
    For i = 1 → pop_size:
        p_i = inv_fit_i / S
    End For

    count = 0
    i = 1
    While count < pop_size:
        Nếu rand() < p_i:
            Thực hiện tìm kiếm lân cận như ong thợ (giống đoạn trên)
            count = count + 1
        i = i + 1
        Nếu i > pop_size: i = 1
    End While

    --- Pha ong do thám ---
    For i = 1 → pop_size:
        Nếu trial_i > limit:
            Khởi tạo lại x_i ngẫu nhiên
            trial_i = 0
    End For

    Cập nhật best_solution = nghiệm có fitness tốt nhất hiện tại

End For

Return best_solution.position, best_solution.fitness
